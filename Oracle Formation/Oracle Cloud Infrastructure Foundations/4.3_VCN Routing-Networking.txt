Welcome back to this lesson on OCI routing. As you can see from this graphic here, we have this concept of a route table. VCN uses route tables to send traffic out of the VCN to the internet, to on-premises networks, or to peered VCN, and we look at each of these scenarios.

Route tables consist of a set of route rules. Each rule specifies a destination CIDR block and a route target. Think about route target as the next hop for the traffic that matches that destination CIDR block.

Now, one thing to keep in mind is traffic within the VCN subnet is automatically handled by the VCN local routing. So you see a public subnet and a private subnet here. There is no routing needed for routing the data. There's no entry in a route table needed for routing that data between the public subnet and the private subnet. That's taken care by VCN itself.

So how does this work in reality? As you can see here, I have a private subnet and a public subnet and I'm showing you the route table only for the private subnet just for illustration purposes. And as you can see here, there are two kinds of data movement happening from the private subnet.

We are leveraging the NAT gateway. Probably there is a database running here, so you're using a NAT gateway to go and get some patches from the internet. So you can see that green arrow going all the way from the NAT gateway to the internet.

And then the second part is you are using a Dynamic Routing Gateway. That's kind of a virtual router you use for on-premises communication, and it's going through on-premises environment. Maybe you are running a DNS server on premises where the database needs to get its DNS resolved.

Now, if you look at the route table entries, we have two entries there. There's a CIDR notation, decision CIDR, and there's a route target. The first one says 0.0.0.0/0 and goes to NAT gateway. The second one has a CIDR block for on-premises network.

So how does this work in reality? Well, what happens is the route table looks at both the routes and the route which is more specific or gets priority. We also sometimes refer to as the longest prefix match. So if you look at these two CIDR blocks, the /16 is bigger or more specific than /0, so that takes priority.

So first, the traffic goes through the Dynamic Routing Gateway to your on-premises environment, your DNS servers. And then the traffic which is not destined for your on-premises environment goes to the internet through the NAT gateway, and hopefully to get a patch in this example. So this is a very quick illustration, but hopefully it shows you how the route table works.

Now, there's also one scenario we haven't talked about earlier which is peering. If you have multiple networks, how do they talk to each other? So there are two scenarios which are possible here.

If the networks are within the same OCI region, they can talk to each other through a mechanism called local peering. And you can see here we have this concept of a local peering gateway. That's kind of a virtual router which lets you manage that communication.

If the two networks are in two different OCI data center regions, then you have the same concept, a similar concept, but it's a remote peering now. And instead of using local peering, now you're using the Dynamic Routing Gateways. Remember we talked about Dynamic Routing Gateways used for on-premises communication, anything which is not for internet. So this is also a use case for Dynamic Routing Gateway enabling communication between networks in different regions.

Now, one thing you might look at that picture and say this is great if there are two networks talking to each other within a region. Pretty straightforward to use something like a local peering gateway. What happens if you have let's say, 10 of those VCNs? Or God forbid, if you have 300 of those VCNs, how are you going to communicate?

In a real complex environment, this is a possibility. This is a reality. Many customers struggle with a lot of networks. And so how does that communication happen in case you have large number of networks?

So in this case, what we have done is we have launched a newer version of DRG. It's called DRG v2. And what it does is you no longer need to maintain point-to-point connectivity using a local peering gateway, instead the VCNs can communicate using DRG. And this feature also lets you scale up to 300 VCNs on a single DRG. If this option is not enough, you can always connect an extra DRG through a remote peering connection. So the idea is to simplify and scale this experience using this DRG v2.

So to wrap up, in this section, we looked at OCI routing and how VCN uses route tables so to send traffic out to the VCN, to the internet, to on-premises network, or to a peered VCN. Thanks for watching. 